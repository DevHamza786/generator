# Laravel Scheduler Cron Job Setup for cPanel

## ğŸ• Automatic Daily Cleanup Setup

### Step 1: Kernel.php File Created âœ…
The `app/Console/Kernel.php` file has been created with the auto cleanup scheduler.

### Step 2: Set Up Cron Job in cPanel

1. **Login to your cPanel**
2. **Go to "Cron Jobs" section**
3. **Add new cron job with these settings:**

**Minute:** *
**Hour:** *
**Day:** *
**Month:** *
**Weekday:** *

**Command:**
```bash
cd /home/username/public_html/your-project-folder && php artisan schedule:run >> /dev/null 2>&1
```

**Replace `username` and `your-project-folder` with your actual values.**

### Step 3: Verify Setup

The scheduler will now:
- âœ… **Run every minute** to check for scheduled tasks
- âœ… **Execute cleanup daily at 2:00 AM**
- âœ… **Keep only latest 10 days** of data
- âœ… **Log results** to `storage/logs/cleanup.log`
- âœ… **Prevent overlapping** runs

### Step 4: Test the Setup

**Test the command manually first:**
```bash
php artisan cleanup:logs --days=10
```

**Check if scheduler is working:**
```bash
php artisan schedule:list
```

**View cleanup logs:**
```bash
tail -f storage/logs/cleanup.log
```

## ğŸ“Š What Happens Daily

**Every day at 2:00 AM:**
1. âœ… Checks all log tables
2. âœ… Deletes data older than 10 days
3. âœ… Keeps only latest 10 days
4. âœ… Logs the cleanup process
5. âœ… Sends email notification (if enabled)

## ğŸ”§ Customization Options

### Change Cleanup Time
Edit `app/Console/Kernel.php`:
```php
$schedule->command('cleanup:logs --days=10')
         ->dailyAt('03:00')  // Change to 3:00 AM
         ->withoutOverlapping();
```

### Change Days to Keep
```php
$schedule->command('cleanup:logs --days=7')  // Keep 7 days
         ->dailyAt('02:00')
         ->withoutOverlapping();
```

### Add Email Notifications
Uncomment this line in `app/Console/Kernel.php`:
```php
->emailOutputTo('admin@yourdomain.com');
```

## ğŸ“‹ Complete Setup Checklist

- [x] âœ… `app/Console/Kernel.php` created with scheduler
- [x] âœ… `app/Console/Commands/AutoCleanupCommand.php` created
- [x] âœ… `database/seeders/AutoCleanupSeeder.php` created
- [ ] â³ Set up cron job in cPanel
- [ ] â³ Test manual command first
- [ ] â³ Monitor first automatic run
- [ ] â³ Check cleanup logs

## ğŸš¨ Important Notes

1. **Test manually first** before setting up automatic
2. **Backup database** before first run
3. **Monitor logs** for first few days
4. **Check disk space** - cleanup will free up space
5. **Adjust timing** if needed (2 AM is usually good)

## ğŸ“§ Email Notifications (Optional)

To get email notifications when cleanup runs, uncomment this line in `app/Console/Kernel.php`:
```php
->emailOutputTo('admin@yourdomain.com');
```

## ğŸ›¡ï¸ Safety Features

- âœ… **Overlap protection** - prevents multiple runs
- âœ… **Detailed logging** - all activities logged
- âœ… **Error handling** - continues if some records fail
- âœ… **Only affects logs** - other data remains safe
- âœ… **Backup reminder** - always backup first

---
**Status:** âœ… Ready for automatic daily cleanup
**Next Step:** Set up cron job in cPanel
**Frequency:** Daily at 2:00 AM
**Retention:** 10 days of data
